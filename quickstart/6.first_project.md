## 创建第一个项目
hydra的项目可以通过gaea创建，在创建前请确保安装了gaea,如果还没安装请查阅[gaea工具安装](https://github.com/qxnw/hydra/blob/master/quickstart/3.install_gaea.md)

### 1. 创建项目
现在一切就绪我们就可以创建项目了，打开终端输入命令:`gaea new hydraDemo --service`

```sh
~/work/bin$ gaea new quickstart --service
[2018/03/06 09:19:00.956377][i][3f97ca0bf]启动 gaea ...
[2018/03/06 09:19:00.956497][i][3f97ca0bf]创建文件: /home/work/src/hydraDemo/main.go 140
[2018/03/06 09:19:00.956531][i][3f97ca0bf]创建文件: /home/work/src/hydraDemo/loader.go 338
[2018/03/06 09:19:00.956594][i][3f97ca0bf]创建文件: /home/work/src/hydraDemo/services/order/order.query.go 518
[2018/03/06 09:19:00.956598][i][3f97ca0bf]项目生成成功: /home/work/src/hydraDemo
```

通过以上命令我们就创建了一个service项目，通过这个项目编写的代码可运行于http api，web，rpc，mqc,cron等服务器，项目的目录结构如下:
	
	
	|-- services                    ---服务目录
	|   --order
	|      -- order.query.go
	|-- main.go                     ---程序入口
	|-- loader.go                   ---服务加载

项目文件说明：

|  文件路径  |  说明   |
|:-------:|:-------|
|main.go|程序入口，初始化，并启动服务器|
|loader.go|服务加载函数，用于注册所有外部服务，并在服务器启动时加载|
|services|存放所有服务实现的代码|


### 2. 配置服务器运行参数
服务器运行参数是通过注册中心管理的，注册中心目前支持zookeeper([安装zookeeper](https://github.com/qxnw/hydra/blob/master/quickstart/4.install_zk.md))，
配置服务器运行参数(端口，路由规则，安全认证等)可以使用hydrd cloud([安装hydrd cloud](https://github.com/qxnw/hydra/blob/master/quickstart/5.install_themis.md))图形界面进行操作，也可以使用zooInspector([安装zooInspector](https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip))手动编写json

####  使用zooInspector配置服务器参数
1. 启动`zooInspector`输入zookeeper服务器地址
2. 创建服务器配置目录,格式： /<平台名称>/<系统名称>/<服务器类型>/<集群标识>/conf

|名称|说明|
|:------:|:------|
|平台名称|项目或平台名称|
|系统名称|子系统名称，如后台管理系统，前端用户系统等|
|服务器类型|可选的服务器类型有:api,rpc,web,mqc,cron|
|集群标识|子系统内的一组服务的集群|

我们按如下结构创建一个`api`服务器配置：
   
	|-- myplat
	|     -- quickstart
	|        -- api
	|           -- order
	|              -- conf
	|                 --router

`conf`,`router`为必须设置节点，/myplat/quickstart/api/order/conf节点和/myplat/quickstart/api/order/conf/router节点的值，我们按以下内容设置:

|节点名称|类型|json配置|说明|
|------|:------:|:------|:-------|
|.../api/order/conf|主配置|{"address":":8081","status":"start"}|服务器状态为启动|
|.../api/order/conf/router|路由配置|{"routers":[{"name":"/order/query","service":"/order/query"}]}|`name`为外部请求地址，`service`为注册的服务名称|


### 3. 启动服务器
#### a. 直接启动
在$GOPATH/bin目录下使用命令`go install quickstart`进行编译，然后执行命令:`./quickstart <平台名称> -r <注册中心地址> -t <集群标识>`

```sh
H97-HD3:~/work/bin$ ./quickstart quickstart -r "zk://192.168.106.18" -t "t"
[2018/03/06 09:53:39.170744][hydra][i][20d36a9e4]Connected to 192.168.106.18:2181
[2018/03/06 09:53:39.174933][hydra][i][20d36a9e4]Re-submitting `0` credentials after reconnect
[2018/03/06 09:53:39.174916][hydra][i][20d36a9e4]Authenticated: id=99447815291405140, timeout=4000
[2018/03/06 09:53:40.170467][hydra][i][20d36a9e4]启动 hydra server(t,zk,v:)...
[2018/03/06 09:53:40.174895][order-api][i][f88267338]开始启动:order.api(t)
[2018/03/06 09:53:40.671032][hydra][i][20d36a9e4]启动成功:health-checker.api(addr:http://192.168.5.71:10160)
[2018/03/06 09:53:40.687893][order-api][i][f88267338]启动成功:order.api(t)(addr:http://192.168.5.71:8081,srvs:1)

```

我们看到服务器quickstart-order-api已启动成功，外部访问地址是http://192.168.5.71:8081,提供的服务数是1个


### 4. 访问服务
  在终端输入命令访问服务: `curl http://http://192.168.5.71:8081/order/query`
```sh
~/work/bin$ curl http://http://192.168.5.71:8081/order/query
hello world

```
返回内容为我们在$GOPATH/src/quickstart/service/myservice.go定义的内容

再看看服务器的执行情况:
```sh
[2018/03/06 10:01:01.972554][order.api(t)][i][2e5a49951]api.request: order GET /order/query from 127.0.0.1
[2018/03/06 10:01:01.973036][order.api(t)][i][2e5a49951]api.response: order GET /order/query 200  547.88µs

```
其中`api.request` 和 `api.response`两行为服务器自动输出的日志，表示请求和响应的信息

+ 至此我们使用`gaea`创建了一个简单的service项目，并通过`zooInspector`配置为http接口服务，并通过`hydra`运行起来，使用`curl`成功访问到了这个服务